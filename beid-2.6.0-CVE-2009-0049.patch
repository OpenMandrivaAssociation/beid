--- belpic-2.6.0.orig/src/eidlib/patch
+++ belpic-2.6.0/src/eidlib/patch
@@ -0,0 +1,23 @@
+--- Verify.cpp.orig	2009-01-09 03:48:56.000000000 +0100
++++ Verify.cpp	2009-01-09 03:42:44.000000000 +0100
+@@ -1013,6 +1013,7 @@
+     unsigned char *pucRNCert = NULL;
+     unsigned long ulRNCertLen = 0;
+     BEID_Certif_Check tCertifs = {0};
++    int evp_ret;
+ 
+     if(m_pCertifManager == NULL)
+     {
+@@ -1084,7 +1085,11 @@
+ 
+     EVP_VerifyInit(&cmd_ctx, EVP_sha1());
+     EVP_VerifyUpdate(&cmd_ctx, pucData, ulDataLen);
+-    iRet = 2*iDiffRNCert + !EVP_VerifyFinal(&cmd_ctx, (unsigned char *)pucSig, ulSigLen, pKey);
++    evp_ret = EVP_VerifyFinal(&cmd_ctx, (unsigned char *)pucSig, ulSigLen, pKey);
++    if(evp_ret >= 0) {
++    	evp_ret = 1 - evp_ret;
++    }
++    iRet = 2*iDiffRNCert + evp_ret;
+     EVP_PKEY_free(pKey);
+     X509_free(pX509);
+     return iRet;
